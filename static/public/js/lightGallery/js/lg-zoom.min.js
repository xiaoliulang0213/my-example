!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){!function(){"use strict";var b=function(){var a=!1,b=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return b&&parseInt(b[2],10)<54&&(a=!0),a},c={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300,useLeftForZoom:b()},d=function(b){return this.core=a(b).data("lightGallery"),this.core.s=a.extend({},c,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=a(window).width()/2,this.pageY=a(window).height()/2+a(window).scrollTop()),this};d.prototype.init=function(){var d,e,f,g,h,b=this,c='<span id="lg-zoom-in" class="lg-icon" title="'+b.core.s.tooltips.zoomIn+'"></span><span id="lg-zoom-out" class="lg-icon" title="'+b.core.s.tooltips.zoomOut+'"></span>';b.core.s.actualSize&&(c+='<span id="lg-actual-size" class="lg-icon" title="'+b.core.s.tooltips.realSize+'"></span>'),b.core.s.useLeftForZoom?b.core.$outer.addClass("lg-use-left-for-zoom"):b.core.$outer.addClass("lg-use-transition-for-zoom"),this.core.$outer.find(".lg-toolbar").append(c),b.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(c,d,e){var f=b.core.s.enableZoomAfter+e;a("body").hasClass("lg-from-hash")&&e?f=0:a("body").removeClass("lg-from-hash")}),d=1,e=function(c){var d=b.core.$outer.find(".lg-current .lg-image"),g=a(window).width()/2,h=a(window).height()/2+a(window).scrollTop(),e=b.pageX-g,f=b.pageY-h,i=(c-1)*e,j=(c-1)*f,k=d.attr("data-rotate");void 0===k?d.css("transform","scale3d("+c+", "+c+", 1)").attr("data-scale",c):d.css("transform","scale3d("+c+", "+c+", 1) rotate("+k+"deg)").attr("data-scale",c),1===c?a("#lg-actual-size").attr("title",b.core.s.tooltips.realSize):a("#lg-actual-size").attr("title",b.core.s.tooltips.fitScreen),b.core.s.useLeftForZoom?d.parent().css({left:-i+"px",top:-j+"px"}).attr("data-x",i).attr("data-y",j):d.parent().css("transform","translate3d(-"+i+"px, -"+j+"px, 0)").attr("data-x",i).attr("data-y",j)},f=function(){d>1?b.core.$outer.addClass("lg-zoomed"):b.resetZoom(),1>d&&(d=1),e(d)},g=function(c,e,g){var i,j,k,l,m;return b.core.cropper?(i=b.core.cropper.cropper("getImageData"),j=b.core.cropper.cropper("getContainerData"),i&&j&&i.naturalWidth&&i.naturalWidth===i.width?(a("#lg-actual-size").attr("title",b.core.s.tooltips.realSize),b.core.cropper.cropper("zoomTo",Math.min(j.width/i.naturalWidth,j.height/i.naturalHeight))):(a("#lg-actual-size").attr("title",b.core.s.tooltips.fitScreen),b.core.cropper.cropper("zoomTo",1)),void 0):(k=e.prop("offsetWidth"),l=b.core.s.dynamic?b.core.s.dynamicEl[g].width||e[0].naturalWidth||k:b.core.items[g].width||e[0].naturalWidth||k,b.core.$outer.hasClass("lg-zoomed")?(a("#lg-actual-size").attr("title",b.core.s.tooltips.realSize),d=1):(a("#lg-actual-size").attr("title",b.core.s.tooltips.fitScreen),l>k&&(m=l/k,d=m||2)),b.pageX=a(window).width()/2,b.pageY=a(window).height()/2+a(window).scrollTop(),f(),setTimeout(function(){b.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10),void 0)},h=!1,b.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(a,c){var d=b.core.$slide.eq(c).find(".lg-image");d.on("dblclick",function(a){g(a,d,c)}),d.on("touchstart",function(a){h?(clearTimeout(h),h=null,g(a,d,c)):h=setTimeout(function(){h=null},300),a.preventDefault()})}),a(window).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){b.pageX=a(window).width()/2,b.pageY=a(window).height()/2+a(window).scrollTop(),e(d)}),a("#lg-zoom-out").on("click.lg",function(){if(b.core.$outer.find(".lg-current .lg-image").length){if(null!=b.core.cropper)return b.core.cropper.cropper("zoom",-.1),void 0;d-=b.core.s.scale,f()}}),a("#lg-zoom-in").on("click.lg",function(){if(b.core.$outer.find(".lg-current .lg-image").length){if(null!=b.core.cropper)return b.core.cropper.cropper("zoom",.1),void 0;d+=b.core.s.scale,f()}}),a("#lg-actual-size").on("click.lg",function(a){g(a,b.core.$slide.eq(b.core.index).find(".lg-image"),b.core.index,!0)}),b.core.$el.on("onBeforeSlide.lg.tm",function(){d=1,b.resetZoom()}),b.zoomDrag(),b.zoomSwipe(),b.core.s.mousewheel&&b.mousewheel()},d.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=a(window).width()/2,this.pageY=a(window).height()/2+a(window).scrollTop()},d.prototype.zoomSwipe=function(){var a=this,b={},c={},d=!1,e=!1,f=!1;a.core.$slide.on("touchstart.lg",function(c){if(a.core.$outer.hasClass("lg-zoomed")){var d=a.core.$slide.eq(a.core.index).find(".lg-object");f=(parseInt(d.attr("data-height"),10)||d.prop("offsetHeight"))*d.attr("data-scale")>a.core.$outer.find(".lg").height(),e=(parseInt(d.attr("data-width"),10)||d.prop("offsetWidth"))*d.attr("data-scale")>a.core.$outer.find(".lg").width(),(e||f)&&(c.preventDefault(),b={x:c.originalEvent.targetTouches[0].pageX,y:c.originalEvent.targetTouches[0].pageY})}}),a.core.$slide.on("touchmove.lg",function(g){var h,i,j;a.core.$outer.hasClass("lg-zoomed")&&(h=a.core.$slide.eq(a.core.index).find(".lg-img-wrap"),g.preventDefault(),d=!0,c={x:g.originalEvent.targetTouches[0].pageX,y:g.originalEvent.targetTouches[0].pageY},a.core.$outer.addClass("lg-zoom-dragging"),j=f?parseInt(h.attr("data-y"),10)+(c.y-b.y):parseInt(h.attr("data-y"),10),i=e?parseInt(h.attr("data-x"),10)+(c.x-b.x):parseInt(h.attr("data-x"),10),(Math.abs(c.x-b.x)>15||Math.abs(c.y-b.y)>15)&&(a.core.s.useLeftForZoom?h.css({left:i+"px",top:j+"px"}):h.css("transform","translate3d("+i+"px, "+j+"px, 0)")))}),a.core.$slide.on("touchend.lg",function(){a.core.$outer.hasClass("lg-zoomed")&&d&&(d=!1,a.core.$outer.removeClass("lg-zoom-dragging"),a.touchendZoom(b,c,e,f))})},d.prototype.zoomDrag=function(){var b=this,c={},d={},e=!1,f=!1,g=!1,h=!1;b.core.$slide.on("mousedown.lg.zoom",function(d){var f=b.core.$slide.eq(b.core.index).find(".lg-object");h=(parseInt(f.attr("data-height"),10)||f.prop("offsetHeight"))*f.attr("data-scale")>b.core.$outer.find(".lg").height(),g=(parseInt(f.attr("data-width"),10)||f.prop("offsetWidth"))*f.attr("data-scale")>b.core.$outer.find(".lg").width(),b.core.$outer.hasClass("lg-zoomed")&&a(d.target).hasClass("lg-object")&&(g||h)&&(d.preventDefault(),c={x:d.pageX,y:d.pageY},e=!0,b.core.$outer.scrollLeft+=1,b.core.$outer.scrollLeft-=1,b.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),a(window).on("mousemove.lg.zoom",function(a){var i,j,k;e&&(i=b.core.$slide.eq(b.core.index).find(".lg-img-wrap"),f=!0,d={x:a.pageX,y:a.pageY},b.core.$outer.addClass("lg-zoom-dragging"),k=h?parseInt(i.attr("data-y"),10)+(d.y-c.y):parseInt(i.attr("data-y"),10),j=g?parseInt(i.attr("data-x"),10)+(d.x-c.x):parseInt(i.attr("data-x"),10),b.core.s.useLeftForZoom?i.css({left:j+"px",top:k+"px"}):i.css("transform","translate3d("+j+"px, "+k+"px, 0)"))}),a(window).on("mouseup.lg.zoom",function(a){e&&(e=!1,b.core.$outer.removeClass("lg-zoom-dragging"),!f||c.x===d.x&&c.y===d.y||(d={x:a.pageX,y:a.pageY},b.touchendZoom(c,d,g,h)),f=!1),b.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},d.prototype.touchendZoom=function(a,b,c,d){var e=this,f=e.core.$slide.eq(e.core.index).find(".lg-img-wrap"),g=e.core.$slide.eq(e.core.index).find(".lg-object"),h=parseInt(f.attr("data-x"),10)+(b.x-a.x),i=parseInt(f.attr("data-y"),10)+(b.y-a.y),j=(e.core.$outer.find(".lg").height()-(parseInt(g.attr("data-height"),10)||g.prop("offsetHeight"))*Math.abs(g.attr("data-scale")))/2,k=(parseInt(g.attr("data-height"),10)||g.prop("offsetHeight"))*Math.abs(g.attr("data-scale"))-e.core.$outer.find(".lg").height()+j,l=(e.core.$outer.find(".lg").width()-(parseInt(g.attr("data-width"),10)||g.prop("offsetWidth"))*Math.abs(g.attr("data-scale")))/2,m=(parseInt(g.attr("data-width"),10)||g.prop("offsetWidth"))*Math.abs(g.attr("data-scale"))-e.core.$outer.find(".lg").width()+l;(Math.abs(b.x-a.x)>15||Math.abs(b.y-a.y)>15)&&(d&&(i>=k?i=k:j>=i&&(i=j)),c&&(h>=m?h=m:l>=h&&(h=l)),d?f.attr("data-y",i):i=parseInt(f.attr("data-y"),10),c?f.attr("data-x",h):h=parseInt(f.attr("data-x"),10),e.core.s.useLeftForZoom?f.css({left:h+"px",top:i+"px"}):f.css("transform","translate3d("+h+"px, "+i+"px, 0)"))},d.prototype.mousewheel=function(){var b=this;b.core.$outer.on("mousewheel.lg",function(c){null==b.cropper&&c.deltaY&&(c.deltaY>0?a("#lg-zoom-in").trigger("click"):a("#lg-zoom-out").trigger("click"),c.preventDefault())})},d.prototype.destroy=function(){var b=this;b.core.$el.off(".lg.zoom"),a(window).off(".lg.zoom"),b.core.$slide.off(".lg.zoom"),b.core.$el.off(".lg.tm.zoom"),b.resetZoom(),b.zoomabletimeout=!1},a.fn.lightGallery.modules.zoom=d}()});