!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){!function(){"use strict";var b={thumbnail:!0,animateThumb:!0,currentPagerPosition:"middle",thumbWidth:100,thumbHeight:"80px",thumbContHeight:100,thumbMargin:5,exThumbImage:!1,showThumbByDefault:!0,toogleThumb:!0,pullCaptionUp:!0,enableThumbDrag:!0,enableThumbSwipe:!0,swipeThreshold:50,loadYoutubeThumbnail:!0,youtubeThumbSize:1,loadVimeoThumbnail:!0,vimeoThumbSize:"thumbnail_small",loadDailymotionThumbnail:!0},c=function(c){return this.core=a(c).data("lightGallery"),this.core.s=a.extend({},b,this.core.s),this.$el=a(c),this.$thumbOuter=null,this.thumbOuterWidth=0,this.thumbTotalWidth=this.core.items.length*(this.core.s.thumbWidth+this.core.s.thumbMargin),this.thumbIndex=this.core.index,this.core.s.animateThumb&&(this.core.s.thumbHeight="100%"),this.left=0,this.init(),this};c.prototype.init=function(){var a=this;this.core.s.thumbnail&&this.core.items.length>1&&(this.core.s.showThumbByDefault&&setTimeout(function(){a.core.$outer.addClass("lg-thumb-open")},700),this.core.s.pullCaptionUp&&this.core.$outer.addClass("lg-pull-caption-up"),this.build(),this.core.s.animateThumb&&this.core.doCss()?(this.core.s.enableThumbDrag&&this.enableThumbDrag(),this.core.s.enableThumbSwipe&&this.enableThumbSwipe(),this.thumbClickable=!1):this.thumbClickable=!0,this.toogle(),this.thumbkeyPress())},c.prototype.build=function(){function g(a,e,f,g,h){var j,i=b.core.isVideo(a,h)||{},k="";i.youtube||i.vimeo||i.dailymotion?i.youtube?j=b.core.s.loadYoutubeThumbnail?"//img.youtube.com/vi/"+i.youtube[1]+"/"+b.core.s.youtubeThumbSize+".jpg":e:i.vimeo?b.core.s.loadVimeoThumbnail?(j="//i.vimeocdn.com/video/error_"+d+".jpg",k=i.vimeo[1]):j=e:i.dailymotion&&(j=b.core.s.loadDailymotionThumbnail?"//www.dailymotion.com/thumbnail/video/"+i.dailymotion[1]:e):j=e,f?f=b.core.analysisUrl(f):j=b.core.analysisUrl(j),c+='<div data-vimeo-id="'+k+'" class="lg-thumb-item" style="width:'+b.core.s.thumbWidth+"px; height: "+b.core.s.thumbHeight+"; margin-right: "+b.core.s.thumbMargin+'px">'+'<img title="'+g+'" src="'+j+'"'+(f?' data-lazy="'+f+'"':"")+"/>"+"</div>",k=""}var e,h,b=this,c="",d="",f='<div class="lg-thumb-outer"><div class="lg-thumb lg-group"></div></div>';switch(this.core.s.vimeoThumbSize){case"thumbnail_large":d="640";break;case"thumbnail_medium":d="200x150";break;case"thumbnail_small":d="100x75"}if(b.core.$outer.addClass("lg-has-thumb"),b.core.$outer.find(".lg").append(f),b.$thumbOuter=b.core.$outer.find(".lg-thumb-outer"),b.thumbOuterWidth=b.$thumbOuter.width(),b.core.s.animateThumb&&b.core.$outer.find(".lg-thumb").css({width:b.thumbTotalWidth+"px",position:"relative"}),this.core.s.animateThumb&&b.$thumbOuter.css("height",b.core.s.thumbContHeight+"px"),b.core.s.dynamic)for(h=0;h<b.core.s.dynamicEl.length;h++)g(b.core.s.dynamicEl[h].src,b.core.s.dynamicEl[h].thumb,h);else for(h=0;h<this.core.items.length;h++)g(this.core.items[h].url,this.core.items[h].thumbUrl,this.core.items[h].lazyUrl,this.core.items[h].tooltip,h);b.core.$outer.find(".lg-thumb").html(c),e=b.core.$outer.find(".lg-thumb-item"),e.each(function(){var c=a(this),d=c.attr("data-vimeo-id");d&&a.getJSON("//www.vimeo.com/api/v2/video/"+d+".json?callback=?",{format:"json"},function(a){c.find("img").attr("src",a[0][b.core.s.vimeoThumbSize])})}),e.eq(b.core.index).addClass("active"),b.core.$el.on("onBeforeSlide.lg.tm",function(){e.removeClass("active"),e.eq(b.core.index).addClass("active")}),b.core.$el.on("onImageChange.lg",function(a,c,d){if(d)if("refresh"===d){var f=b.core.items[c].lazyUrl||b.core.items[c].thumbUrl;e.eq(b.core.index).find("img").attr("src",f+(f.indexOf("?")>0?"&":"?")+"_lg="+(new Date).getTime())}else e.eq(b.core.index).find("img").attr("src",d.lazyUrl||d.thumbUrl)}),e.on("click.lg touchend.lg",function(){var c=a(this);setTimeout(function(){(b.thumbClickable&&!b.core.lgBusy||!b.core.doCss())&&(b.core.index=c.index(),b.core.slide(b.core.index,!1,!0,!1))},50)}),b.core.$el.on("onBeforeSlide.lg.tm",function(){b.animateThumb(b.core.index)}),b=this,this.core.$el.on("onAfterThumbSlide.lg",function(c,d){var e,f,g,h,i,j,k;if(!b.core.lazyLoadingComplete){for(e=b.$thumbOuter.outerWidth(!0),f=b.$thumbOuter.find(".lg-thumb-item").first().outerWidth(!0),g=parseInt(e/f,10)+1,h=parseInt(d/f,10)-2,0>h&&(h=0),i=10,j=b.core.$outer.find(".lg-thumb-item").eq(h),k=0;g+i>k;k++)j&&1===j.length&&a("img",j).attr("data-lazy")&&(a("img",j).attr("src",a("img",j).attr("data-lazy")),a("img",j).removeAttr("data-lazy")),j=j.next();0===b.core.$outer.find(".lg-thumb-item img[data-lazy]").length&&(b.core.lazyLoadingComplete=!0)}}),this.core.$el.on("onImageDelete.lg",function(a,c){b.core.$outer.find(".lg-thumb-item").eq(c).remove(),b.thumbTotalWidth=b.core.items.length*(b.core.s.thumbWidth+b.core.s.thumbMargin),e=b.core.$outer.find(".lg-thumb-item")}),a(window).on("resize.lg.thumb orientationchange.lg.thumb",function(){setTimeout(function(){b.animateThumb(b.core.index),b.thumbOuterWidth=b.$thumbOuter.width()},200)})},c.prototype.setTranslate=function(a){if(this.core.$outer.find(".lg-thumb").css({transform:"translate3d(-"+a+"px, 0px, 0px)"}),this.core.translateValue=a,!this.core.doing){this.core.doing=!0;var b=this;setTimeout(function(){b.core.$el.trigger("onAfterThumbSlide.lg",b.core.translateValue||0),b.core.doing=!1},500)}},c.prototype.animateThumb=function(a){var c,b=this.core.$outer.find(".lg-thumb");if(this.core.s.animateThumb){switch(this.core.s.currentPagerPosition){case"left":c=0;break;case"middle":c=this.thumbOuterWidth/2-this.core.s.thumbWidth/2;break;case"right":c=this.thumbOuterWidth-this.core.s.thumbWidth}this.left=(this.core.s.thumbWidth+this.core.s.thumbMargin)*a-1-c,this.left>this.thumbTotalWidth-this.thumbOuterWidth&&(this.left=this.thumbTotalWidth-this.thumbOuterWidth),this.left<0&&(this.left=0),this.core.lGalleryOn?(b.hasClass("on")||this.core.$outer.find(".lg-thumb").css("transition-duration",this.core.s.speed+"ms"),this.core.doCss()||b.animate({left:-this.left+"px"},this.core.s.speed)):this.core.doCss()||b.css("left",-this.left+"px"),this.setTranslate(this.left)}},c.prototype.enableThumbDrag=function(){var b=this,c=0,d=0,e=!1,f=!1,g=0;b.$thumbOuter.addClass("lg-grab"),b.core.$outer.find(".lg-thumb").on("mousedown.lg.thumb",function(a){b.thumbTotalWidth>b.thumbOuterWidth&&(a.preventDefault(),c=a.pageX,e=!0,b.core.$outer.scrollLeft+=1,b.core.$outer.scrollLeft-=1,b.thumbClickable=!1,b.$thumbOuter.removeClass("lg-grab").addClass("lg-grabbing"))}),a(window).on("mousemove.lg.thumb",function(a){e&&(g=b.left||0,f=!0,d=a.pageX,b.$thumbOuter.addClass("lg-dragging"),g-=d-c,g>b.thumbTotalWidth-b.thumbOuterWidth&&(g=b.thumbTotalWidth-b.thumbOuterWidth),0>g&&(g=0),b.setTranslate(g))}),a(window).on("mouseup.lg.thumb",function(){f?(f=!1,b.$thumbOuter.removeClass("lg-dragging"),b.left=g,Math.abs(d-c)<b.core.s.swipeThreshold&&(b.thumbClickable=!0)):b.thumbClickable=!0,e&&(e=!1,b.$thumbOuter.removeClass("lg-grabbing").addClass("lg-grab"))})},c.prototype.enableThumbSwipe=function(){var a=this,b=0,c=0,d=!1,e=0;a.core.$outer.find(".lg-thumb").on("touchstart.lg",function(c){a.thumbTotalWidth>a.thumbOuterWidth&&(c.preventDefault(),b=c.originalEvent.targetTouches[0].pageX,a.thumbClickable=!1)}),a.core.$outer.find(".lg-thumb").on("touchmove.lg",function(f){a.thumbTotalWidth>a.thumbOuterWidth&&(f.preventDefault(),c=f.originalEvent.targetTouches[0].pageX,d=!0,a.$thumbOuter.addClass("lg-dragging"),e=a.left,e-=c-b,e>a.thumbTotalWidth-a.thumbOuterWidth&&(e=a.thumbTotalWidth-a.thumbOuterWidth),0>e&&(e=0),a.setTranslate(e))}),a.core.$outer.find(".lg-thumb").on("touchend.lg",function(){a.thumbTotalWidth>a.thumbOuterWidth?d?(d=!1,a.$thumbOuter.removeClass("lg-dragging"),Math.abs(c-b)<a.core.s.swipeThreshold&&(a.thumbClickable=!0),a.left=e):a.thumbClickable=!0:a.thumbClickable=!0})},c.prototype.toogle=function(){var b=this;b.core.s.toogleThumb&&(b.core.$outer.addClass("lg-can-toggle"),b.$thumbOuter.append('<span class="lg-toogle-thumb lg-icon" title="'+b.core.s.tooltips.hideThumb+'"></span>'),b.$thumbOuter.append('<span class="lg-prev-thumb lg-icon" title="'+b.core.s.tooltips.pageLeft+'"></span>'),b.$thumbOuter.append('<span class="lg-next-thumb lg-icon" title="'+b.core.s.tooltips.pageRight+'"></span>'),b.core.$outer.find(".lg-prev-thumb").on("click.lg",function(){var a=b.$thumbOuter.outerWidth(!0),c=b.left-a;0>c&&(c=0),b.left=c,b.core.doCss()||b.core.$outer.find(".lg-thumb").animate({left:-b.left+"px"},b.core.s.speed),b.setTranslate(b.left)}),b.core.$outer.find(".lg-next-thumb").on("click.lg",function(){var a=b.$thumbOuter.outerWidth(!0),c=b.left+a;c>b.thumbTotalWidth-b.thumbOuterWidth&&(c=b.thumbTotalWidth-b.thumbOuterWidth),b.left=c,b.core.doCss()||b.core.$outer.find(".lg-thumb").animate({left:-b.left+"px"},b.core.s.speed),b.setTranslate(b.left)}),b.core.$outer.find(".lg-toogle-thumb").on("click.lg",function(){b.core.$outer.toggleClass("lg-thumb-open"),b.core.$outer.hasClass("lg-thumb-open")?a(".lg-toogle-thumb").attr("title",b.core.s.tooltips.hideThumb):a(".lg-toogle-thumb").attr("title",b.core.s.tooltips.showThumb)}))},c.prototype.thumbkeyPress=function(){var b=this;a(window).on("keydown.lg.thumb",function(a){38===a.keyCode?(a.preventDefault(),b.core.$outer.addClass("lg-thumb-open")):40===a.keyCode&&(a.preventDefault(),b.core.$outer.removeClass("lg-thumb-open"))})},c.prototype.destroy=function(){this.core.s.thumbnail&&this.core.items.length>1&&(a(window).off("resize.lg.thumb orientationchange.lg.thumb keydown.lg.thumb"),this.$thumbOuter.remove(),this.core.$outer.removeClass("lg-has-thumb"))},a.fn.lightGallery.modules.Thumbnail=c}()});